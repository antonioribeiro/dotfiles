#!/bin/bash

# -- Overrides
# You can create files to override the following configuration files:
#
# config.defaults.sh = config.sh *** CHECK THE FILE CONFIG.DEFAULTS.SH FOR MORE INSTRUCTIONS
# .brew_packages.defaults = .brew_packages
# .composer_packages.defaults = .composer_packages 
# .npm_packages.defaults = .npm_packages 
# ---

function install
{
    check_variables

    # configure_macos 

    # configure_git

    # install_homebrew

    # install_hushlogin

    # install_ohmyzsh

    # install_global_gitignore

    # install_zsh_prefs

    # install_vim_prefs

    # install_yarn_prefs

    # install_ohmyzsh_themes ### looks line this one is not working anymore

    # install_powerline_fonts ### looks like the current fix for oh my zsh fonts
    
    # install_z

    # install_php

    # install_composer

    # install_node

    # install_pkg_config

    # install_wget 

    # install_httpie

    # install_ncdu

    # install_hub
    
    # install_ack
    
    # install_doctl
    
    # install_imagemagick

    # install_memcached
    
    # install_redis

    # install_postgresql

    # install_mysql

    # install_yarn

    # install_ghostscript

    # install_mackup

    # install_zsh_autosuggestions
    
    # install_quicklook_plugins

    # install_autoconf

    # install_xcode_select

    # install_php_pear

    # install_joe

    # install_nginx

    # install_dnsmasq

    # install_laravel_valet

    # install_prettier

    # install_composer_packages

    # install_brew_packages

    # install_npm_packages

    install_pecl_packages

    # fix_file_permissions

    # display_instructions    
}


function check_errors() 
{    
    if [ $? -ne 0 ]
    then
        echo

        echo_error "=== COMMAND EXECUTION FAILED ==="

        FATAL_ERROR=YES
    fi  
}


function configure_environment()
{

    source helpers.sh
    check_errors; [ "$_FATAL_ERROR" = "YES" ] && return 0

    source installers.sh
    check_errors; [ "$_FATAL_ERROR" = "YES" ] && return 0

    source config.defaults.sh
    check_errors; [ "$_FATAL_ERROR" = "YES" ] && return 0

    source shell/.aliases
    check_errors; [ "$_FATAL_ERROR" = "YES" ] && return 0

    [ "$_FATAL_ERROR" = "YES" ] && return 0    
    load_installable_packages

    # overrides
    source config.sh 2>/dev/null
}

## Execute

configure_environment
install
display_errors
